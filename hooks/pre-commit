#!/bin/bash
#==============================================================================
# Ralph Loop - Pre-commit Hook
#==============================================================================
# This hook runs validation before each commit to catch common issues.
#
# To install this hook, run:
#   cp hooks/pre-commit .git/hooks/pre-commit
#   chmod +x .git/hooks/pre-commit
#
# Or create a symlink:
#   ln -sf ../../hooks/pre-commit .git/hooks/pre-commit
#==============================================================================

REPO_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"

echo "Running Ralph Loop validation..."
echo ""

if [ -f "$REPO_ROOT/tests/validate.sh" ]; then
    "$REPO_ROOT/tests/validate.sh"
    exit_code=$?

    if [ $exit_code -ne 0 ]; then
        echo ""
        echo "❌ Validation failed. Please fix the issues above before committing."
        exit 1
    fi
else
    echo "⚠️  tests/validate.sh not found, skipping validation"
fi

exit 0

